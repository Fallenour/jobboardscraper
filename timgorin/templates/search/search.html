{% extends 'base.html' %}

{% load highlight humanize %}


{% block title %}Search {% if query %}&#8220;{{ query }}&#8221;{% endif %} &#183; {{ block.super }}{% endblock %}


{% block search %}
{% endblock %}


{% block content %}

<h1>Search</h1>

<div class="row">
    <div class="col-lg-12">

        {{ search_form.non_field_errors }}

        <form method="get" action="{% url 'search' %}">

            {% for field in search_form %}
                {% if field.is_hidden %}
                {{ field }}
                {% endif %}
            {% endfor %}

            <div class="input-group">
                {{ search_form.q }}
                <span class="input-group-btn">
                    <button type="submit" data-submit="Searching" class="btn btn-lg btn-primary">Search</button>
                </span>
            </div>

        </form>

    </div>
</div>

{% if query %}

    {% if page.object_list %}
        <h2>Results {{ page.start_index }}&#8211;{{ page.end_index }} of {{ page.paginator.count|intcomma }}</h2>
    {% else %}
        <h2></h2>
        <p>No results found.</p>
    {% endif %}

    {% for result in page.object_list %}
    <div class="result">
        <p><a href="{{ result.object.get_absolute_url }}">{{ result.object.title }}</a></p>
        <p>{% highlight result.object.body with query %}</p>
    </div>
    {% endfor %}

    {% if page.has_previous or page.has_next %}
    <div class="text-center">
        <nav>
            <ul class="pagination">
                {% if page.has_previous %}
                <li><a href="?q={{ query|urlencode }}&amp;page={{ page.previous_page_number }}">&laquo;</a></li>
                {% endif %}
                {% for number in paginator.page_range %}
                <li{% if page.number == number %} class="active"{% endif %}><a href="?q={{ query|urlencode }}&amp;page={{ number }}">{{ number }}</a></li>
                {% endfor %}
                {% if page.has_next %}
                <li><a href="?q={{ query|urlencode }}&amp;page={{ page.next_page_number }}">&raquo;</a></li>
                {% endif %}
            </ul>
        </nav>
    </div>
    {% endif %}

{% endif %}

{% endblock %}
